<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <!-- Template para MedicalReport -->
    <t t-name="chatter_voice_note.MedicalReport" owl="1">
        <div class="medical-report-container">
            <div class="medical-report bg-white p-4 shadow-lg">
                <!-- Header del Reporte -->
                <div class="report-header d-flex justify-content-between align-items-start border-bottom pb-3 mb-4">
                    <div class="report-title-section">
                        <h1 class="report-title text-primary mb-1">
                            <t t-esc="reportTitle"/>
                        </h1>
                        <p class="text-muted mb-0">Reporte generado autom√°ticamente</p>
                    </div>
                    <div class="report-logo">
                        <div class="logo-placeholder bg-light rounded p-3 text-center border">
                            <!-- Logo de la compa√±√≠a -->
                            <t t-if="state.companyLogo">
                                <img t-att-src="'data:image/png;base64,' + state.companyLogo" 
                                    alt="Logo Compa√±√≠a" 
                                    style="max-width: 120px; max-height: 60px; object-fit: contain;"/>
                            </t>
                            <t t-else="">
                                <!-- Placeholder si no hay logo -->
                                <i class="fa fa-hospital text-primary fa-2x mb-2"></i>
                                <div class="small fw-bold">
                                    <t t-esc="state.companyName || 'CENTRO M√âDICO'"/>
                                </div>
                            </t>
                        </div>
                    </div>
                </div>

                <!-- Contenido del Reporte -->
                <div class="report-content mb-4">
                    <div class="medical-content text-center py-4 px-3 bg-light rounded border">
                        <div t-out="props.content" class="medical-text fs-5 lh-base"/>
                    </div>
                </div>

                <!-- Footer del Reporte -->
                <div class="report-footer border-top pt-3">
                    <div class="row">
                        <div class="col-6">
                            <div class="doctor-signature">
                                <p class="mb-1 fw-bold">
                                    <t t-if="state.userName">
                                        <t t-esc="state.userName"/>
                                    </t>
                                    <t t-else="">
                                        Cargando...
                                    </t>
                                </p>
                                <p class="text-muted small mb-0">
                                    <t t-if="state.userJobTitle">
                                        <t t-esc="state.userJobTitle"/>
                                    </t>
                                    <t t-else="">
                                        Cargando puesto...
                                    </t>
                                </p>
                            </div>
                        </div>
                        <div class="col-6 text-end">
                            <p class="text-muted mb-0">
                                <strong>Fecha:</strong> 
                                <span t-esc="currentDate"/>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Acciones del Reporte -->
                <div class="report-actions mt-4 pt-3 border-top">
                    <div class="d-flex gap-2 justify-content-end">
                        <button type="button" class="btn btn-outline-secondary btn-sm" 
                                t-on-click="props.onClose">
                            ‚ùå Cerrar
                        </button>
                        <button type="button" class="btn btn-outline-primary btn-sm"
                                t-on-click="printReport">
                            üñ®Ô∏è Imprimir
                        </button>
                        <button type="button" class="btn btn-primary btn-sm"
                            t-on-click="downloadPDF">
                        üìÑ Descargar PDF
                    </button>
                        <button type="button" class="btn btn-primary btn-sm"
                                t-on-click="sendEmail"
                                t-att-disabled="!props.contacts or props.contacts.length === 0"
                                t-att-class="(!props.contacts or props.contacts.length === 0) ? 'btn-secondary' : 'btn-primary'">
                            <t t-if="props.contacts and props.contacts.length > 0">
                                üìß Enviar a <t t-esc="props.contacts.length"/> contacto(s)
                            </t>
                            <t t-else="">
                                üìß Enviar por Correo
                            </t>
                        </button>
                    </div>

                    <!-- INFO DE CONTACTOS -->
                    <t t-if="props.contacts and props.contacts.length > 0">
                        <div class="mt-2 text-end">
                            <small class="text-muted">
                                Enviando a: 
                                <t t-foreach="props.contacts" t-as="contact" t-key="contact.id">
                                    <span t-esc="contact.name"/>
                                    <t t-if="contact_index lt props.contacts.length - 1">, </t>
                                </t>
                            </small>
                        </div>
                    </t>
                </div>
            </div>
        </div>
    </t>

</templates>